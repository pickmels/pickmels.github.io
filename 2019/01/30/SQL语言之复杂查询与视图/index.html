<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SQL语言之复杂查询与视图"><meta name="keywords" content="数据库系统"><meta name="author" content="湛兮,undefined"><meta name="copyright" content="湛兮"><title>SQL语言之复杂查询与视图 | 湛兮的小日常</title><link rel="shortcut icon" href="/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars0.githubusercontent.com/u/46594910?s=460&amp;v=4"></div><div class="author-info__name text-center">湛兮</div><div class="author-info__description text-center">Don't wait for luck!</div><div class="follow-button"><a href="https://github.com/pickmels" target="_blank">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">23</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">3</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://github.com" target="_blank">GitHub</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://images.hdbackgroundpictures.com/pictureHD519490da0b8d478469.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">湛兮的小日常</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">SQL语言之复杂查询与视图</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-01-30</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">5.6k</span><span class="post-meta__separator">|</span><span>阅读时长: 21 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>数据库系统系列第七章<br><a id="more"></a></p>
<p>1、已知S(S#,SN,AGE,SEX),S#学号，SN姓名。若要检索所有比’王华’年龄大的学生姓名、年龄和性别，正确的SELECT语句是<strong><strong>_</strong></strong>。<br>    <strong><em>A.SELECT SN, AGE, SEX  FROM S WHERE AGE&gt;(SELECT AGE  FROM  S WHERE SN=’王华’)</em></strong><br>    B.SELECT SN,AGE,SEX FROM S WHERE SN=’王华’<br>    C.SELECT SN,AGE,SEX FROM S WHERE AGE&gt;(SELECT AGE WHERE SN=’王华’)<br>    D.SELECT SN,AGE,SEX FROM S WHERE AGE &gt; 王华.AGE<br><img src="/2019/01/30/SQL语言之复杂查询与视图/001.png" alt=""></p>
<p>2、在SQL语言中，子查询是<strong><strong>_</strong></strong>。<br>    <strong><em>A.嵌入到另一个查询语句之中的查询语句</em></strong><br>    B.返回单表中数据子集的查询语言<br>    C.返回单表中数据子集的查询语言<br>    D.选取单表中字段子集的查询语句<br><img src="/2019/01/30/SQL语言之复杂查询与视图/002.png" alt=""></p>
<p>3、设关系Teacher的结构为：Teacher（T# char(3), Tname char(10), D# char(2), Salary float(2))，其中T#教师编号，Tname教师姓名，D#系号，Salary工资。Dept（D# char(2),Dname char(10),Dean char(10)),Dname系名，Dean系主任。若要将所有计算机系的教师工资上调10%，则可用<strong><strong>_</strong></strong>。<br>    <strong><em>A.Update Teacher Set Salary = Salary </em> 1.1 Where  D#  in ( Select D# From Dept Where Dname=‘计算机’);*</strong><br>    B.Update Salary = Salary <em> 1.1 Where D# in ( Select D# From Dept Where Dname =‘计算机’);<br>    C.Update Salary = Salary </em> 1.1 Where D# in (Select D#  From Dept Where Dname = 计算机);<br>    D.Update TABLE Teacher Set Salary = Salary * 1.1 Where D# in ( Select D# From Dept Where Dname = ‘计算机’);<br><img src="/2019/01/30/SQL语言之复杂查询与视图/003.png" alt=""></p>
<p>4、已知Titles(Title_Id char(4), Title char(20), Pub_id char(4), price integer)，其中Title_Id图书编号，Title图书名，Pub_id出版商编号，price价格。列出Titles表中其价格高于出版商ID为0736的出版商出版的书的最大价格的书的标题和ID，合适的查询语句是<strong><strong>_</strong></strong>。<br>    <strong><em>A.SELECT Title_Id，Title FROM Titles WHERE price＞ALL（SELECT price FROM Titles WHERE Pub_id=‘0736’）</em></strong><br>    B.SELECT Title_Id，Title FROM Titles WHERE price＞ALL（SELECT price FROM Titles） AND Pub_id=‘0736’<br>    C.SELECT Title_Id，Title FROM Titles WHERE price＞ANY（SELECT price FROM Titles WHERE Pub_id=‘0736’）<br>    D.SELECT Title_Id，Title FROM Titles WHERE price＞ANY（SELECT price FROM Titles） AND Pub_id=‘0736’<br><img src="/2019/01/30/SQL语言之复杂查询与视图/004.png" alt=""></p>
<p>5、陈述A：SubQuery1 UNION SubQuery2语句，其中SubQuery1和SubQuery2查询中相应的列必须以同一顺序出现。 陈述B：GROUP BY和HAVING子句不能在子查询中使用，这些子句只能用在最后一个查询结束时来总结和排序最后结果集。 关于陈述A和B，下列说法正确的是<strong><strong>_</strong></strong>。<br>    <strong><em>A.陈述A正确，陈述B错误</em></strong><br>    B.都是正确的<br>    C.都是错误的<br>    D.陈述A错误，陈述B正确<br><img src="/2019/01/30/SQL语言之复杂查询与视图/005-1.png" alt=""><br><img src="/2019/01/30/SQL语言之复杂查询与视图/005-2.jpg" alt=""></p>
<p>6、下面有关HAVING子句，说法不正确的是<strong><strong>_</strong></strong>。<br>    <strong><em>A.使用HAVING子句的同时不能使用WHERE子句</em></strong><br>    B.HAVING子句必须与GROUP BY 子句同时使用，不能单独使用<br>    C.使用HAVING子句的同时可以使用WHERE子句<br>    D.使用HAVING子句的作用是过滤掉不满足条件的分组<br><img src="/2019/01/30/SQL语言之复杂查询与视图/006.jpg" alt=""></p>
<p>7、在SQL中，与”NOT IN”等价的操作符是<strong><strong>_</strong></strong>。<br>    <strong><em>A.&lt;&gt; ALL</em></strong><br>    B.= SOME<br>    C.&lt;&gt; SOME<br>    D.= ALL<br><img src="/2019/01/30/SQL语言之复杂查询与视图/007.png" alt=""></p>
<p>8、以下定义的4个视图中，能够进行更新操作的是<strong><strong>_</strong></strong>。<br>    <strong><em>A.CREATE VIEW S_MALE(学号,姓名) AS SELECT 学号,姓名 FROM student WHERE 班号=’09031’</em></strong><br>    B.CREATE VIEW S_G(学号,姓名,课程名,分数) AS SELECT S.学号,姓名,课程名,分数 FROM student S,score SC,course C WHERE S.学号=SC. 学号AND SC. 课程号 = C. 课程号<br>    C.CREATE VIEW S_AVG(学号,平均分) AS SELECT 学号,AVG(分数) FROM score<br>    WHERE 分数IS NOT NULL  GROUP BY 学号<br>    D.CREATE VIEW S_FEMALE(姓名,出生日期) AS SELECT 姓名,出生日期 FROM student  WHERE 性别=’女’<br><img src="/2019/01/30/SQL语言之复杂查询与视图/008.jpg" alt=""></p>
<p>9、已知选课关系SC(S# char(8), C# char(8), GRADE integer)，S#学号，C#课程号，GRADE成绩。检索选修4门以上课程的学生总成绩（不统计不及格的课程），并要求按总成绩的降序排列出来。正确的SELECT语句是<strong><strong>_</strong></strong>。</p>
<pre><code>A.SELECT S#,SUM(GRADE) as Sgrade FROM SC  WHERE GRADE&gt;=60  GROUP BY S#
HAVING COUNT(*)&gt;=4  ORDER BY Sgrade DESC    
B.SELECT S#,SUM(GRADE) as Sgrade FROM  SC  WHERE GRADE&gt;=60  GROUP BY S# HAVING COUNT(*)&gt;=4 ORDER BY Sgrade
C.SELECT S#,SUM(GRADE) as Sgrade FROM SC WHERE GRADE&gt;=60 HAVING COUNT(*)&gt;=4 GROUP BY S# ORDER BY Sgrade DESC
D.SELECT S#,SUM(GRADE) as Sgrade  FROM SC  WHERE GRADE&gt;=60 and COUNT(*)&gt;=4 GROUP BY S# ORDER BY Sgrade DESC
</code></pre><p><img src="/2019/01/30/SQL语言之复杂查询与视图/009.png" alt=""></p>
<p>10、已知选课关系SC(S# char(8), C# char(8), GRADE integer)，S#学号，C#课程号，GRADE成绩。检索选修课程’C2’的学生中成绩最高的学生的学号。正确的SELECT语句是<strong><strong>_</strong></strong>。<br>    A.SELECT S# FROM SC WHERE C#=’C2’ AND GRADE &gt;= ALL(SELECT GRADE FROM SC WHERE C#=’C2’)<br>    B.SELECT S# FROM SC WHERE C#=’C2’ AND GRADE &gt;=(SELECT GRADE FROM SC<br>    WHERE C#=’C2’)<br>    C.SELECT S# FROM SC WHERE C#=’C2’ AND GRADE IN (SELECT GRADE FROM SC<br>    WHERE C#=’C2’)<br>    D.SELECT S# FROM SC WHERE C#=’C2’ AND GRADE NOT IN(SELECT GRADE FROM SC WHERE C#=’C2’)<br><img src="/2019/01/30/SQL语言之复杂查询与视图/010.png" alt=""></p>
<p>11、关于SQL视图更新的可执行性，下列说法不正确的是<strong><strong>_</strong></strong>。<br>    A.对于由单一Table子集构成的视图，即如果视图是从单个基本表使用选择、投影操作导出的，并且包含了基本表的主键，则不能更新<br>    B.如果视图的select目标列包含聚集函数，则不能更新<br>    C.如果视图中包括了group by子句，则不能更新<br>    D.如果视图是由单个表的列构成，但并没有包括主键，则不能更新<br><img src="/2019/01/30/SQL语言之复杂查询与视图/011.png" alt=""></p>
<p>12、已知关系模式Student (S#  char(8) Primary key, Sname   char(10), Ssex char(2),Sage  integer,  D#  char(2), Sclass  char(6))，在此基础上定义了视图create view CStud(S#, Sname, Sclass) as ( select S#, Sname, Sclass from  Student where D# =‘03’)。若要对该视图进行更新，下列语句正确的是<strong><strong>_</strong></strong>。<br>    A.Insert  into CStud Values  ( “98030104”, “张三丰”, “980301” );<br>    B.Insert into CStud Values (98030104, “张三丰”, “980301”);<br>    C.insert into CStud values (“98030104”, 张三丰, Null, Null, “03” , “980301”);<br>    D.insert  into CStud values (Null, “张三丰”, “980301”);<br><img src="/2019/01/30/SQL语言之复杂查询与视图/012-1.png" alt=""><br><img src="/2019/01/30/SQL语言之复杂查询与视图/012-2.png" alt=""></p>
<p>13、合并多个查询结果集，应使用<strong><strong>_</strong></strong>保留字。<br>    A.union<br>    B.join<br>    C.into<br>    D.and<br><img src="/2019/01/30/SQL语言之复杂查询与视图/013.png" alt=""></p>
<p>14、假如有两个表的连接是这样的：table_1 INNER JOIN table_2，其中table_1和table_2是两个具有公共属性的表，这种连接会生成哪种结果集<strong><strong>_</strong></strong>。<br>    A.只包括table_1和table_2中满足条件的行的组合结果<br>    B.包括table_1中的所有行但不包括table_2的不匹配行的所有组合结果<br>    C.包括table_2中的所有行但不包括table_1的不匹配行的所有组合结果<br>    D.包括两个表的所有行的组合结果<br><img src="/2019/01/30/SQL语言之复杂查询与视图/014.png" alt=""></p>
<p>15、有关SQL语言的空值处理，以下说法不正确的是<strong><strong>_</strong></strong>。<br>    A.除is [not] null之外，空值满足任何查找条件<br>    B.如果null参与比较运算，有些情况下是可以判断为真的或为假的。<br>    C.如果null参与聚集运算，则除count(*)之外其它聚集函数都忽略null<br>    D.如果null参与算术运算，则该算术表达式的值为null<br><img src="/2019/01/30/SQL语言之复杂查询与视图/015.png" alt=""></p>
<p>16、求既学过002号课，又学过003号课的同学学号，下列SQL语句不正确的是<strong><strong>_</strong></strong>。<br>    A.Select S# From SC Where C# = ‘002’ AND C#=‘003’;<br>    B.Select S#  From SC Where C# = ‘002’ INTERSECT Select S# From SC Where C# = ‘003’;<br>    C.Select S# From SC Where C# = ‘002’ and S# IN (Select S# From SC Where C# =‘003’);<br>    D.Select S1.S# From SC S1, SC S2 Where S1.S# = S2.S# and S1.C#=‘002’ and  S2.C#=‘003 ;<br><img src="/2019/01/30/SQL语言之复杂查询与视图/016.png" alt=""></p>
<p>17、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句：<br>SELECT Sname FROM Student WHERE S# NOT IN<br>(SELECT S# FROM SC WHERE Student.S#=SC.S# and C#= ‘C01’ and Score&gt;=60)；<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.剔出掉C01号课程及格学生的其他学生的姓名<br>    B.C01号课程及格的所有学生的姓名<br>    C.C01号课程不及格的所有学生的姓名<br>    D.剔出掉C01号课程不及格学生的其他学生的姓名<br><img src="/2019/01/30/SQL语言之复杂查询与视图/017-1.png" alt=""><br><img src="/2019/01/30/SQL语言之复杂查询与视图/017-2.png" alt=""></p>
<p>18、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句<br>SELECT Sname FROM Student WHERE S# IN<br>(SELECT S# FROM SC WHERE Student.S#=SC.S# and C#= ‘C01’ and Score&gt;=60)；<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.C01号课程及格的所有学生的姓名<br>    B.C01号课程不及格的所有学生的姓名<br>    C.剔出掉C01号课程不及格学生的其他学生的姓名<br>    D.剔出掉C01号课程及格学生的其他学生的姓名<br><img src="/2019/01/30/SQL语言之复杂查询与视图/018.png" alt=""></p>
<p>19、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句<br>SELECT Sname FROM Student WHERE S#  NOT IN<br>( SELECT S#  FROM  SC, Course  WHERE  T# = ‘03’  and SC.C# = C.C#)；<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.没学过03号教师讲授过的任一门课的学生的姓名<br>    B.学过03号教师讲授过的某一门课的学生的姓名<br>    C.学过03号教师讲授过的所有门课的学生的姓名<br>    D.没学全03号教师讲授过的所有门课的学生的姓名<br><img src="/2019/01/30/SQL语言之复杂查询与视图/019.png" alt=""></p>
<p>20、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句<br>SELECT S# FROM SC WHERE Score<60 group="" by="" c#="" having="" count(*)="">2；<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.有2人以上不及格课程的同学的学号<br>    B.有2门以上不及格课程的同学的学号<br>    C.有2门以上及格课程的同学的学号<br>    D.有2人以上及格课程的同学的学号<br><img src="/2019/01/30/SQL语言之复杂查询与视图/020.jpg" alt=""></60></p>
<p>21、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句<br>SELECT S# FROM SC WHERE Score<60 and="" count(*)="">2 GROUP BY S#；<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.其它选项的说法都不正确<br>    B.有2门以上不及格课程的同学的学号<br>    C.有2门以上及格课程的同学的学号<br>    D.有2人以上不及格课程的同学的学号<br><img src="/2019/01/30/SQL语言之复杂查询与视图/021.png" alt=""></60></p>
<p>22、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句<br>Select  Sname  From  Student Where S# NOT IN ( Select S#  From  SC, Course C, Teacher  T Where   T.T＃ = ‘李明’  and  SC.C# = C.C#  and T.T# = C.T#  );<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.列出没学过李明老师讲授任一课程的学生姓名<br>    B.列出学全了李明老师讲授所有课程的学生姓名<br>    C.列出学过李明老师讲授某一课程的学生姓名<br>    D.列出没学全李明老师讲授所有课程的学生姓名<br><img src="/2019/01/30/SQL语言之复杂查询与视图/022.png" alt=""></p>
<p>23、已知如下关系：学生Student(S#, Sname)，课程Course(C#, Cname, T#)，选课SC(S#, C#, Score)，教师T(T#, Tname)。其中S#为学号，Sname为学生命名，C#为课号，Cname为课程名，T#为教师编号，Score为成绩，Tname为教师名。<br>阅读SQL语句<br>Select  S#  From  SC SC1 Where SC1.C# = ‘C01’  AND S# IN<br>(Select  S#  From  SC SC2 Where SC2.C# = ‘C02’  AND SC1.S#=SC2.S# AND SC1.Score&gt;SC2.Score)；<br>关于其查询结果，下列说法正确的是<strong>_</strong>。<br>    A.C01课程比C02课程成绩高的所有学生的学号<br>    B.C01同学比C02同学成绩高的所有课程的课号<br>    C.比C02课程成绩高的所有学生的学号<br>    D.其它选项的说法都不正确<br><img src="/2019/01/30/SQL语言之复杂查询与视图/023.jpg" alt=""></p>
<p>24、现有关系数据库如下：学生（学号，姓名，性别，专业、奖学金），课程（课程号，课程名，学分），选课（学号，课程号，分数），用SQL语言实现题目：检索没有任何一门课程成绩在80分以下的所有学生的信息，包括学号、姓名和专业，正确的SQL语句是<strong>_</strong>。<br>    A.SELECT 学号，姓名，专业 FROM 学生 WHERE 学号 NOT  IN  (SELECT 学号 FROM 选课  WHERE 分数&lt;80)<br>    B.SELECT 学号，姓名，专业 FROM 学生，选课 WHERE 学号 NOT  IN  (SELECT 学号 FROM 选课  WHERE 分数&lt;80)<br>    C.SELECT 学号，姓名，专业 FROM 学生，选课 WHERE 学号 IN  (SELECT 学号 FROM 选课   WHERE 分数&lt;80)<br>    D.SELECT 学号，姓名，专业 FROM 学生  WHERE 学号 IN  (SELECT 学号 FROM 选课  WHERE 学生.学号=选课.学号 AND分数&lt;80)<br><img src="/2019/01/30/SQL语言之复杂查询与视图/024.png" alt=""></p>
<p>25、现有关系数据库如下： 学生（学号，姓名，性别，专业、奖学金），课程（课程号，课程名，学分），选课（学号，课程号，分数）， 用SQL语言实现题目：对成绩得过满分(100分)的学生，如果没有获得奖学金的，将其奖学金设为1000元，正确的SQL语句是<strong>_</strong>。<br>    A.UPDATE 学生 SET 奖学金=1000 WHERE  奖学金&lt;=0  AND  学号  IN (SELECT  学号 FROM 选课  WHERE 分数=100)<br>    B.UPDATE 学生 SET 奖学金=1000 WHERE 奖学金≤0  AND 学号 IN (SELECT 学号  FROM 选课   WHERE 分数=100)<br>    C.UPDATE 学生 SET 奖学金=’1000’WHERE 奖学金&lt;=0 AND 学号 IN (SELECT 学号   FROM 选课  WHERE 分数=100)<br>    D.UPDATE 学生 SET 奖学金=1000  WHERE 奖学金&lt;=0  AND 学号 NOT IN (SELECT 学号  FROM 选课  WHERE 分数=100)<br><img src="/2019/01/30/SQL语言之复杂查询与视图/025.png" alt=""></p>
<p>26、如下几个表所示学生、课程、必修课和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/026-1.jpg" alt=""><br>求既学过“1001”号课，又学过“2002”号课的所有学生的学号。正确的SQL语句是<strong>_</strong>。<br>    A.SELECT DISTINCT 学号　FROM 选课　WHERE 课号＝‘1001’ AND<br>    学号 IN　(SELECT DISTINCT 学号　FROM   选课　WHERE  课号＝‘2002’ )；<br>    B.SELECT  DISTINCT 学号　FROM  选课　WHERE   课号=‘1001’  AND  课号=‘2002’；<br>    C.SELECT DISTINCT 学号　FROM 选课　WHERE 课号＝‘1001’ AND 学号 IN　( FROM   选课　WHERE  课号＝‘2002’ )；<br>    D.SELECT DISTINCT 学号　FROM 选课　WHERE 课号＝‘1001’ AND<br>    学号　(SELECT DISTINCT 学号　FROM   选课 WHERE  课号＝‘2002’ )<br><img src="/2019/01/30/SQL语言之复杂查询与视图/026-2.png" alt=""></p>
<p>27、如下几个表所示学生、课程、必修课和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/026-1.jpg" alt=""><br>列出各门课的平均成绩、最高成绩、最低成绩和选课人数。正确的SQL语句是<strong>_</strong>。<br>    A.SELECT 课号，AVG(成绩)，MAX(成绩)，MIN(成绩)，COUNT(学号)　<br>    FROM   选课　GROUP BY 课号；<br>    B.SELECT 课号，AVG(成绩)，MAX(成绩)，MIN(成绩)，COUNT(学号)<br>    FROM   选课　ORDER BY 课号；<br>    C.SELECT 课号，AVG(成绩)，MAX(成绩)，MIN(成绩)，COUNT(学号)<br>    FROM 选课　WHERE  课号；<br>    D.SELECT 课号，AVG(成绩)，MAX(成绩)，MIN(成绩)，COUNT(学号)<br>    FROM   选课　HAVING 课号；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/027.png" alt=""></p>
<p>28、如下几个表所示学生、课程、必修课和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/026-1.jpg" alt=""><br>列出最少选修了三门课程的学生姓名。正确的SQL语句是<strong>_</strong>。</p>
<pre><code>A.SELECT 姓名　FROM  学生　WHERE 学号 IN　
(SELECT  学号　FROM   选课　GROUP  BY  学号　HAVING  COUNT(*) &gt;= 3)；
B.SELECT 姓名　FROM  学生　WHERE 学号  IN
(SELECT 学号　FROM  选课　GROUP BY 学号　COUNT(*) &gt;= 3)；
C.SELECT 姓名　FROM  学生　WHERE 学号  
(SELECT  学号　FROM  选课　GROUP BY 学号　HAVING COUNT(*) &gt;= 3)；
D.SELECT 姓名　FROM  学生　WHERE 学号 IN 
(SELECT  学号　FROM  选课　ORDER  BY  学号　HAVING  COUNT(*) &gt;= 3)；
</code></pre><p><img src="/2019/01/30/SQL语言之复杂查询与视图/028.jpg" alt=""></p>
<p>29、如下几个表所示学生、课程和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-1.jpg" alt=""><br>查询秋季学期有一门以上课程获90分以上成绩的学生名。正确的SQL语句是<strong>_</strong>。<br>    A.SELECT 姓名　FROM 学生　WHERE 学号 IN<br>    (SELECT 学号 FROM 　选课　WHERE 成绩 &gt;= 90.0 AND 课程号　IN<br>    (SELECT  课程号 　FROM   课程　WHERE  开课学期=‘秋’））；<br>    B.SELECT 姓名　FROM 学生 课程 选课<br>    WHERE 学生.学号=选课.学号 AND 选课.课程号=课程.课程号 AND 成绩 &gt;= 90.0  AND  开课学期=’秋’；<br>    C.SELECT 姓名　FROM 学生　WHERE 学号 IN　<br>    (学号 FROM 选课<br>    WHERE 成绩 &gt;= 90.0  AND 课程号　IN<br>    (SELECT  课程号 FROM   课程　WHERE  开课学期=‘秋’））；<br>    D.SELECT 姓名 FROM 学生 WHERE 学号 IN<br>    (SELECT 学号 FROM 选课 WHERE 成绩 &gt;= 90.0  AND 课程号 IN<br>    (课程号  FROM   课程 WHERE  开课学期=‘秋’））；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-2.jpg" alt=""></p>
<p>30、如下几个表所示学生、课程和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-1.jpg" alt=""><br>试列出计算机系所开课程（CS标志）的最高成绩、最低成绩和平均成绩。如果某门课程的成绩不全（即“成绩”中有NULL出现），则该课程不予统计，结果按“课程号”升序排列。正确的SQL语句是<strong>_</strong>。<br>    A.SELECT 课程号，MAX(成绩)，MIN(成绩)，AVG(成绩) FROM 选课<br>    WHERE 课程号 Like ‘CS%’ GROUP BY 课程号 HAVING 课程号 NOT IN<br>    (SELECT 课程号 FROM 选课 WHERE 成绩 IS  NULL)<br>     ORDER  BY  课程号；<br>    B.SELECT 课程号，MAX(成绩)，MIN(成绩)，AVG(成绩) FROM 选课<br>    WHERE 课程号 Like ‘CS%’ GROUP BY 课程号<br>    HAVING 课程号 IN (SELECT 课程号 FROM  选课 WHERE 成绩 IS  NULL)<br>    ORDER BY  课程号；<br>    C.SELECT MAX(成绩)，MIN(成绩)，AVG(成绩) FROM 选课<br>    WHERE 课程号= ‘CS%’ GROUP BY 课程号<br>    HAVING 课程号 NOT IN (SELECT 课程号 FROM 选课 WHERE 成绩 IS NULL)<br>    ORDER BY  课程号；<br>    D.SELECT 课程号，MAX(成绩)，MIN(成绩)，AVG(成绩) FROM 选课<br>    WHERE  课程号 Like ‘CS%’ GROUP BY  课程号<br>    HAVING 课程号 NOT IN (SELECT 课程号 FROM  选课 WHERE 成绩 IS NULL)<br><img src="/2019/01/30/SQL语言之复杂查询与视图/030.jpg" alt=""></p>
<p>31、假设一个元组在子查询1中出现m次，在子查询2中出现n次，其中m&gt;0,n&gt;0, 则下列说法正确的是<strong><strong> </strong></strong>。<br>    A.该元组在“子查询1  Except  子查询2”中出现0次；<br>    B.该元组在“子查询1  Union  子查询2”中出现m + n次；<br>    C.该元组在 “子查询1  Except  ALL  子查询2”中出现m – n次；<br>    D.该元组在“子查询1  Intersect  子查询2”中出现min(m,n)次；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/031.jpg" alt=""></p>
<p>32、假设一个元组在子查询1中出现m次，在子查询2中出现n次，其中m&gt;0,n&gt;0,则下列说法正确的是<strong><strong>_</strong></strong>。<br>    A.该元组在“子查询1  Union  ALL 子查询2”中出现m + n次；<br>    B.该元组在 “子查询1 Union  子查询2”中出现m+n次；<br>    C.该元组在“子查询1  Union  ALL 子查询2”中出现1次；<br>    D.该元组在 “子查询1 Union  子查询2”中出现Min(m,n)次；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/032.png" alt=""></p>
<p>33、假设一个元组在子查询1中出现m次，在子查询2中出现n次，其中m&gt;0,n&gt;0,则下列说法正确的是<strong><strong>_</strong></strong>。<br>    A.该元组在“子查询1  Except  子查询2”中出现0次；<br>    B.该元组在“子查询1  Union  子查询2”中出现m + n次；<br>    C.该元组在 “子查询1  Except All 子查询2”中出现m – n次；<br>    D.该元组在“子查询1  Union All  子查询2”中出现max(m,n)次；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/033.png" alt=""></p>
<p>34、在下列关于视图的叙述中，正确的是<strong>___</strong>。<br>    A.当某一视图删除后，由该视图导出的其它视图也将自动删除；<br>    B.若导出某视图的基本表被删除，该视图将不受任何影响；<br>    C.视图—旦建立，就不能被删除；<br>    D.当修改某一视图时，导出该视图的基本表也随之修改。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/034.png" alt="">    </p>
<p>35、SQL语言中的视图是一种<strong><strong>_</strong></strong>。<br>    A.子模式及子模式到模式的映像；<br>    B.全局模式及全局模式到子模式的映像；<br>    C.内模式及内模式到模式的映像；<br>    D.模式及模式到概念模式的映像；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/035.png" alt="">       </p>
<p>36、如下几个表所示学生、课程和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-1.jpg" alt=""><br>查询缺成绩的学生名及课程号。正确的SQL语句是<strong>_</strong>。<br>    A.SELECT 姓名，课程号 FROM 学生，选课 WHERE 学生.学号=选课.学号 AND 成绩 IS NULL；<br>    B.SELECT 姓名，课程号 FROM 学生，选课 WHERE 学生.学号=选课.学号 AND 成绩=‘  ’；<br>    C.SELECT 姓名，课程号 FROM 学生，选课 WHERE  成绩 IS NULL；<br>    D.SELECT  姓名，课程号  FROM   学生，选课 WHERE   成绩=‘   ’；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/036.jpg" alt="">     </p>
<p>37、如下几个表所示学生、课程和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-1.jpg" alt=""><br>统计学生的平均身高。正确的SQL语句是<strong>_</strong> 。<br>    A.SELECT  AVG(身高)  FROM  学生；<br>    B.SELECT  COUNT(身高)  FROM  学生；<br>    C.SELECT  身高，AVG(身高)  FROM  学生；<br>    D.SELECT  AVER(身高)  FROM  学生；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/037.jpg" alt=""></p>
<p>38、如下几个表所示学生、课程和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-1.jpg" alt=""><br>查询选修CS-110课程的学生名。正确的SQL语句是<strong>_</strong>。<br>    A.SELECT  姓名  FROM   学生，选课 WHERE  学生.学号=选课.学号  AND  课程号=‘CS-110’；<br>    B.SELECT  姓名 FROM  学生，选课 WHERE  课程号=‘CS-110’；<br>    C.SELECT  姓名 FROM    学生，选课  WHERE   选课.课程号=‘CS-110’；<br>    D.SELECT  姓名  FROM   学生 选课 WHERE  学生.学号=选课.学号  AND  课程号=‘CS-110’；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/038.png" alt=""></p>
<p>39、如下几个表所示学生、课程和选课关系，用SQL语言实现下列操作。<br><img src="/2019/01/30/SQL语言之复杂查询与视图/029-1.jpg" alt=""><br>查询1996年出生的学生姓名及其秋季所修课程的课程号及成绩。正确的SQL语句是<strong>_</strong> 。<br>    A.SELECT  姓名，课程号，成绩 FROM 学生，选课，课程 WHERE  学生.学号=选课.学号  AND 选课.课程号=课程.课程号  AND Year(出生日期)=1996  AND 开课学期=’秋’；<br>    B.SELECT  姓名，课程号，成绩 FROM 学生，选课，课程 WHERE  学生.学号=选课.学号  AND 选课.课程号=课程.课程号  AND 出生日期=1996 AND 开课学期=’秋’；<br>    C.SELECT  姓名，课程号，成绩 FROM 学生，选课，课程 WHERE  学生.出生日期=1996 AND 课程.开课学期=’秋’；<br>    D.SELECT  姓名，课程号，成绩 FROM  学生，选课，课程WHERE  学生.学号=选课.学号 AND 学生.Year(出生日期)=1996　AND 课程.开课学期=’秋’；<br><img src="/2019/01/30/SQL语言之复杂查询与视图/039.jpg" alt=""></p>
<p>40、有一个学生表student，包含主键S#（学生编号）等。又有分数表SC，包含S#（学生编号）、score（分数）等。已知student表中共有50个学生，有45人参加了考试（分数存在SC表中），其中10人不及格。执行以下SQL语句：select * from student where exists (select S# from SC where score&lt;60 )， 可返回<strong><strong>_</strong></strong>条记录。<br>    A.50<br>    B.45<br>    C.10<br>    D.35<br><img src="/2019/01/30/SQL语言之复杂查询与视图/040.png" alt=""></p>
<hr>
<p>Anyway，Fighting is right!</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">湛兮</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/01/30/SQL语言之复杂查询与视图/">http://yoursite.com/2019/01/30/SQL语言之复杂查询与视图/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">湛兮的小日常</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/数据库系统/">数据库系统</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/01/31/2018年度总结/"><i class="fa fa-chevron-left">  </i><span>2018年度总结</span></a></div><div class="next-post pull-right"><a href="/2019/01/29/SQL语言之概述/"><span>SQL语言之概述</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By 湛兮</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>